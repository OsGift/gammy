<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Dashboard</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-100 p-8">

    <!-- Main Container -->
    <div class="max-w-5xl mx-auto">

        <!-- Header -->
        <header class="bg-white rounded-xl shadow-lg p-6 mb-8 flex items-center justify-between">
            <h1 class="text-3xl font-bold text-gray-800 flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield-check"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>
                <span>Service Dashboard</span>
            </h1>
            <div class="flex items-center space-x-4">
                <div class="text-right">
                    <p id="userName" class="font-semibold text-lg">Loading...</p>
                    <p id="userRole" class="text-sm text-gray-500 capitalize">Loading...</p>
                </div>
                <img id="profilePic" src="https://placehold.co/100x100/A1C4FD/ffffff?text=U" alt="Profile Picture" class="w-12 h-12 rounded-full object-cover">
                <button id="editProfileBtn" class="bg-gray-200 text-gray-800 p-2 rounded-full hover:bg-gray-300 transition-colors duration-200" aria-label="Edit Profile">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-edit"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                </button>
            </div>
        </header>

        <!-- Profile Modal (hidden by default) -->
        <div id="profileModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50 hidden">
            <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md mx-4">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Update Profile</h2>
                <form id="profileForm" class="space-y-4">
                    <!-- Profile Picture Upload -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Profile Picture</label>
                        <div class="flex items-center space-x-4">
                            <img id="modalProfilePic" src="" alt="Profile" class="w-16 h-16 rounded-full object-cover">
                            <label for="file-upload" class="cursor-pointer bg-blue-500 text-white font-bold py-2 px-4 rounded-md shadow-md hover:bg-blue-600 transition-colors duration-200">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline mr-2 lucide lucide-upload"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>
                                Upload
                            </label>
                            <input id="file-upload" type="file" class="hidden">
                        </div>
                    </div>
                    
                    <!-- Provider specific fields (conditional) -->
                    <div id="providerFields" class="space-y-4 hidden">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Availability</label>
                            <div class="mt-1 flex items-center space-x-4">
                                <span class="text-gray-500">From:</span>
                                <input type="time" id="availabilityFrom" class="flex-1 px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <span class="text-gray-500">To:</span>
                                <input type="time" id="availabilityTo" class="flex-1 px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        <label class="block text-sm font-medium text-gray-700">Contact Person</label>
                        <div class="space-y-2">
                            <input type="email" placeholder="Contact Person Email" id="contactEmail" class="w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <input type="tel" placeholder="Contact Person Phone" id="contactPhone" class="w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <label class="block text-sm font-medium text-gray-700">Business Details</label>
                        <div class="space-y-2">
                            <input type="email" placeholder="Business Email" id="businessEmail" class="w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <input type="tel" placeholder="Business Phone Number" id="businessPhone" class="w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                    </div>

                    <div class="flex justify-end space-x-4 mt-6">
                        <button type="button" id="closeProfileModal" class="bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-md hover:bg-gray-400 transition-colors duration-200">Cancel</button>
                        <button type="submit" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-md shadow-lg hover:bg-blue-700 transition-colors duration-200">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Admin Dashboard Section (conditional) -->
        <section id="adminDashboard" class="bg-white rounded-xl shadow-lg p-6 mb-8 hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bar-chart"><line x1="12" x2="12" y1="20" y2="10"/><line x1="18" x2="18" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="16"/></svg>
                <span>Admin Dashboard</span>
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-blue-50 p-6 rounded-lg border border-blue-200 shadow-sm">
                    <p class="text-lg text-blue-800 font-semibold mb-2">Average Completion Time</p>
                    <p id="avgCompletionTimeAdmin" class="text-4xl font-extrabold text-blue-600">N/A</p>
                    <p class="text-sm text-gray-500">Calculated from Ongoing to Completed status.</p>
                </div>
            </div>
        </section>

        <!-- Super Admin Section (conditional) -->
        <section id="superAdminSection" class="bg-white rounded-xl shadow-lg p-6 mb-8 hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield-check"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>
                <span>Admin Management</span>
            </h2>
            <div class="space-y-4">
                <button id="addAdminBtn" class="bg-green-600 text-white font-bold py-2 px-4 rounded-md shadow-md hover:bg-green-700 transition-colors duration-200">
                    Add New Admin
                </button>
                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-700 mb-2">Current Admins</h3>
                    <ul id="adminList" class="divide-y divide-gray-200"></ul>
                </div>
            </div>
        </section>

        <!-- Provider Section (conditional) -->
        <section id="providerSection" class="bg-white rounded-xl shadow-lg p-6 mb-8 hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-800 flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-briefcase"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>
                <span>My Bookings</span>
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="bg-blue-50 p-6 rounded-lg border border-blue-200 shadow-sm">
                    <p class="text-lg text-blue-800 font-semibold mb-2">Average Completion Time</p>
                    <p id="avgCompletionTimeProvider" class="text-4xl font-extrabold text-blue-600">N/A</p>
                    <p class="text-sm text-gray-500">Calculated from Ongoing to Completed status.</p>
                </div>
            </div>
            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-700 mb-2">My Current Bookings</h3>
                <ul id="providerBookingsList" class="divide-y divide-gray-200"></ul>
            </div>
        </section>

        <!-- Complete Booking Modal (hidden by default) -->
        <div id="completeBookingModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50 hidden">
            <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md mx-4">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Complete Booking</h2>
                <form id="completeBookingForm">
                    <input type="hidden" id="bookingIdToComplete">
                    <div class="mb-4">
                        <label for="proofUpload" class="block text-sm font-medium text-gray-700">Upload Proof (Optional)</label>
                        <input type="file" id="proofUpload" class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100">
                    </div>
                    <div class="mb-4">
                        <label for="completionComment" class="block text-sm font-medium text-gray-700">Comment (Optional)</label>
                        <textarea id="completionComment" rows="3" class="mt-1 block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                    </div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" id="cancelComplete" class="bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-md hover:bg-gray-400">Cancel</button>
                        <button type="submit" class="bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700">Submit</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Reject Booking Modal (hidden by default) -->
        <div id="rejectBookingModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center z-50 hidden">
            <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md mx-4">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Reject Booking</h2>
                <form id="rejectBookingForm">
                    <input type="hidden" id="bookingIdToReject">
                    <div class="mb-4">
                        <label for="rejectionReason" class="block text-sm font-medium text-gray-700">Reason for Rejection</label>
                        <textarea id="rejectionReason" rows="3" class="mt-1 block w-full px-3 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500" required></textarea>
                    </div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" id="cancelReject" class="bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-md hover:bg-gray-400">Cancel</button>
                        <button type="submit" class="bg-red-600 text-white font-bold py-2 px-4 rounded-md hover:bg-red-700">Reject Booking</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Mock Data ---
            let users = [
                { id: 'user1', name: 'Alice Smith', role: 'User', profilePic: 'https://placehold.co/100x100/A1C4FD/ffffff?text=AS' },
                { id: 'mower1', name: 'Bob Johnson', role: 'Mower', profilePic: 'https://placehold.co/100x100/FAD7A1/ffffff?text=BJ' },
                { id: 'provider1', name: 'Clean Cut Lawn Service', role: 'Provider', profilePic: 'https://placehold.co/100x100/A1FDF3/ffffff?text=CL', contactEmail: 'contact@cleancut.com', contactPhone: '123-456-7890', businessEmail: 'business@cleancut.com', businessPhone: '098-765-4321', availabilityFrom: '09:00', availabilityTo: '17:00' },
                { id: 'admin1', name: 'Charlie Davis', role: 'Admin', profilePic: 'https://placehold.co/100x100/FDC1A1/ffffff?text=CD' },
                { id: 'superadmin1', name: 'David Evans', role: 'SuperAdmin', profilePic: 'https://placehold.co/100x100/A2FDFD/ffffff?text=DE' },
            ];

            let bookings = [
                { id: 'b1', status: 'Pending', providerId: 'provider1', clientName: 'Alice', service: 'Lawn Mowing', ongoingTime: null, completionTime: null },
                { id: 'b2', status: 'Completed', providerId: 'provider1', clientName: 'Eve', service: 'Hedge Trimming', ongoingTime: Date.now() - 3600000, completionTime: Date.now() - 1800000 }, // 30-minute completion
                { id: 'b3', status: 'Ongoing', providerId: 'provider1', clientName: 'Frank', service: 'Weed Removal', ongoingTime: Date.now() - 600000, completionTime: null },
                { id: 'b4', status: 'Pending', providerId: 'provider1', clientName: 'Grace', service: 'Leaf Blowing', ongoingTime: null, completionTime: null },
                { id: 'b5', status: 'Rejected', providerId: 'provider1', clientName: 'Heidi', service: 'Tree Pruning', rejectionReason: 'Too far away', ongoingTime: null, completionTime: null }
            ];

            // Change this to switch between roles for testing: user1, mower1, provider1, admin1, superadmin1
            const currentUser = users.find(u => u.id === 'provider1');
            
            // --- Helper Functions ---
            function updateUI() {
                // Update header info
                document.getElementById('userName').textContent = currentUser.name;
                document.getElementById('userRole').textContent = currentUser.role;
                document.getElementById('profilePic').src = currentUser.profilePic;
                document.getElementById('modalProfilePic').src = currentUser.profilePic;

                // Conditional rendering
                const adminDashboard = document.getElementById('adminDashboard');
                const superAdminSection = document.getElementById('superAdminSection');
                const providerSection = document.getElementById('providerSection');

                if (currentUser.role === 'Admin' || currentUser.role === 'SuperAdmin') {
                    adminDashboard.classList.remove('hidden');
                    updateAverageCompletionTime();
                } else {
                    adminDashboard.classList.add('hidden');
                }

                if (currentUser.role === 'SuperAdmin') {
                    superAdminSection.classList.remove('hidden');
                    renderAdminList();
                } else {
                    superAdminSection.classList.add('hidden');
                }

                if (currentUser.role === 'Provider') {
                    providerSection.classList.remove('hidden');
                    updateAverageCompletionTime();
                    renderProviderBookings();
                    document.getElementById('providerFields').classList.remove('hidden');
                } else {
                    providerSection.classList.add('hidden');
                    document.getElementById('providerFields').classList.add('hidden');
                }
            }

            function updateAverageCompletionTime() {
                const completedBookings = bookings.filter(b => b.status === 'Completed' && b.ongoingTime && b.completionTime);
                let totalCompletionTime = 0;
                if (completedBookings.length > 0) {
                    completedBookings.forEach(b => {
                        totalCompletionTime += b.completionTime - b.ongoingTime;
                    });
                    const averageInMs = totalCompletionTime / completedBookings.length;
                    const formattedTime = formatTime(averageInMs);
                    document.getElementById('avgCompletionTimeAdmin').textContent = formattedTime;
                    document.getElementById('avgCompletionTimeProvider').textContent = formattedTime;
                } else {
                    document.getElementById('avgCompletionTimeAdmin').textContent = 'N/A';
                    document.getElementById('avgCompletionTimeProvider').textContent = 'N/A';
                }
            }

            function formatTime(ms) {
                const totalSeconds = Math.floor(ms / 1000);
                const hours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = totalSeconds % 60;
                let result = '';
                if (hours > 0) result += `${hours}h `;
                if (minutes > 0) result += `${minutes}m `;
                if (seconds > 0) result += `${seconds}s`;
                return result.trim() || '0s';
            }

            function renderAdminList() {
                const adminList = document.getElementById('adminList');
                adminList.innerHTML = '';
                const admins = users.filter(u => u.role === 'Admin' || u.role === 'SuperAdmin');
                admins.forEach(admin => {
                    const li = document.createElement('li');
                    li.className = 'py-2 flex items-center justify-between';
                    li.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <img src="${admin.profilePic}" alt="${admin.name}" class="w-8 h-8 rounded-full">
                            <div>
                                <p class="font-medium">${admin.name}</p>
                                <p class="text-sm text-gray-500 capitalize">${admin.role}</p>
                            </div>
                        </div>
                    `;
                    adminList.appendChild(li);
                });
            }

            function renderProviderBookings() {
                const providerBookingsList = document.getElementById('providerBookingsList');
                providerBookingsList.innerHTML = '';
                const myBookings = bookings.filter(b => b.providerId === currentUser.id);
                if (myBookings.length === 0) {
                    providerBookingsList.innerHTML = '<li class="p-4 text-center text-gray-500">No bookings found.</li>';
                }
                myBookings.forEach(booking => {
                    const li = document.createElement('li');
                    li.className = 'p-4 flex items-center justify-between';
                    let statusColor = '';
                    switch (booking.status) {
                        case 'Pending': statusColor = 'bg-yellow-100 text-yellow-800'; break;
                        case 'Ongoing': statusColor = 'bg-blue-100 text-blue-800'; break;
                        case 'Completed': statusColor = 'bg-green-100 text-green-800'; break;
                        case 'Rejected': statusColor = 'bg-red-100 text-red-800'; break;
                    }
                    li.innerHTML = `
                        <div>
                            <p class="font-semibold text-gray-800">${booking.service} for ${booking.clientName}</p>
                            <p class="mt-1 text-sm"><span class="px-2 inline-flex text-xs font-semibold leading-5 rounded-full ${statusColor}">${booking.status}</span></p>
                        </div>
                        <div class="flex space-x-2">
                            ${booking.status === 'Pending' ? `
                                <button data-booking-id="${booking.id}" data-action="ongoing" class="text-blue-600 hover:text-blue-800 font-medium">Ongoing</button>
                                <button data-booking-id="${booking.id}" data-action="reject" class="text-red-600 hover:text-red-800 font-medium">Reject</button>
                            ` : ''}
                            ${booking.status === 'Ongoing' ? `
                                <button data-booking-id="${booking.id}" data-action="complete" class="text-green-600 hover:text-green-800 font-medium">Complete</button>
                            ` : ''}
                        </div>
                    `;
                    providerBookingsList.appendChild(li);
                });
            }

            // --- Event Listeners ---
            document.getElementById('editProfileBtn').addEventListener('click', () => {
                document.getElementById('profileModal').classList.remove('hidden');
                // Pre-fill provider fields if they exist
                if (currentUser.role === 'Provider') {
                    document.getElementById('contactEmail').value = currentUser.contactEmail || '';
                    document.getElementById('contactPhone').value = currentUser.contactPhone || '';
                    document.getElementById('businessEmail').value = currentUser.businessEmail || '';
                    document.getElementById('businessPhone').value = currentUser.businessPhone || '';
                    document.getElementById('availabilityFrom').value = currentUser.availabilityFrom || '';
                    document.getElementById('availabilityTo').value = currentUser.availabilityTo || '';
                }
            });

            document.getElementById('closeProfileModal').addEventListener('click', () => {
                document.getElementById('profileModal').classList.add('hidden');
            });

            document.getElementById('profileForm').addEventListener('submit', (e) => {
                e.preventDefault();
                // Update mock user data
                currentUser.profilePic = document.getElementById('modalProfilePic').src;
                if (currentUser.role === 'Provider') {
                    currentUser.contactEmail = document.getElementById('contactEmail').value;
                    currentUser.contactPhone = document.getElementById('contactPhone').value;
                    currentUser.businessEmail = document.getElementById('businessEmail').value;
                    currentUser.businessPhone = document.getElementById('businessPhone').value;
                    currentUser.availabilityFrom = document.getElementById('availabilityFrom').value;
                    currentUser.availabilityTo = document.getElementById('availabilityTo').value;
                }
                updateUI();
                document.getElementById('profileModal').classList.add('hidden');
            });

            document.getElementById('file-upload').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('modalProfilePic').src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            document.getElementById('addAdminBtn').addEventListener('click', () => {
                const newAdminName = prompt("Enter the new admin's name:");
                if (newAdminName) {
                    const newId = `admin${users.length + 1}`;
                    const newAdmin = {
                        id: newId,
                        name: newAdminName,
                        role: 'Admin',
                        profilePic: `https://placehold.co/100x100/AAAAAA/ffffff?text=${newAdminName.charAt(0)}`
                    };
                    users.push(newAdmin);
                    renderAdminList();
                }
            });

            document.getElementById('providerBookingsList').addEventListener('click', (e) => {
                const button = e.target.closest('button');
                if (!button) return;

                const bookingId = button.dataset.bookingId;
                const action = button.dataset.action;
                const bookingIndex = bookings.findIndex(b => b.id === bookingId);

                if (action === 'ongoing') {
                    bookings[bookingIndex].status = 'Ongoing';
                    bookings[bookingIndex].ongoingTime = Date.now();
                    updateUI();
                } else if (action === 'complete') {
                    document.getElementById('bookingIdToComplete').value = bookingId;
                    document.getElementById('completeBookingModal').classList.remove('hidden');
                } else if (action === 'reject') {
                    document.getElementById('bookingIdToReject').value = bookingId;
                    document.getElementById('rejectBookingModal').classList.remove('hidden');
                }
            });

            document.getElementById('completeBookingForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const bookingId = document.getElementById('bookingIdToComplete').value;
                const comment = document.getElementById('completionComment').value;
                const proofFile = document.getElementById('proofUpload').files[0];

                const bookingIndex = bookings.findIndex(b => b.id === bookingId);
                bookings[bookingIndex].status = 'Completed';
                bookings[bookingIndex].completionTime = Date.now();
                bookings[bookingIndex].comment = comment;

                // For proof, you would upload the file to a server. Here we just log it.
                if (proofFile) {
                    console.log(`Proof uploaded for booking ${bookingId}:`, proofFile);
                }

                document.getElementById('completeBookingModal').classList.add('hidden');
                document.getElementById('completionComment').value = '';
                document.getElementById('proofUpload').value = '';
                updateUI();
            });

            document.getElementById('cancelComplete').addEventListener('click', () => {
                document.getElementById('completeBookingModal').classList.add('hidden');
            });

            document.getElementById('rejectBookingForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const bookingId = document.getElementById('bookingIdToReject').value;
                const reason = document.getElementById('rejectionReason').value;

                const bookingIndex = bookings.findIndex(b => b.id === bookingId);
                bookings[bookingIndex].status = 'Rejected';
                bookings[bookingIndex].rejectionReason = reason;

                document.getElementById('rejectBookingModal').classList.add('hidden');
                document.getElementById('rejectionReason').value = '';
                updateUI();
            });

            document.getElementById('cancelReject').addEventListener('click', () => {
                document.getElementById('rejectBookingModal').classList.add('hidden');
            });

            // Initial UI rendering
            updateUI();
        });
    </script>
</body>
</html>
